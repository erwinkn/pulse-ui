# Pulse UI Python Testing Suite

## ğŸ§ª Test Coverage

This directory contains comprehensive tests for the Pulse UI Python integration system. The tests verify all aspects of the server-side Python to TypeScript bridge.

### Test Files

- **`test_html.py`** - Core UI tree generation and HTML tag functionality
- **`test_components.py`** - React component integration and mount point generation  
- **`test_routes.py`** - Route definition and component dependency tracking
- **`test_codegen.py`** - TypeScript code generation and file writing
- **`test_integration.py`** - Full pipeline integration tests

### Quick Test Runner

Since this environment doesn't have pytest installed, we've included a simple test runner:

```bash
# Run basic functionality tests
python3 test_runner.py

# Run comprehensive example
python3 test_comprehensive_example.py
```

## ğŸ¯ Key Features Tested

### âœ… Direct UI Tree Generation
- **UITreeNode** class creates TypeScript-compatible structures directly
- No HTML string conversion - Python generates JSON-serializable trees
- Proper indexing syntax: `div()[children]` and `div(props)[children]`
- Support for mixed content types (strings, numbers, booleans, nested nodes)

### âœ… React Component Integration  
- **Component Definition**: `define_react_component()` with import paths and export types
- **Mount Point Creation**: Components create `$$componentKey` tagged nodes
- **Server-Rendered Children**: React components can receive and render server-provided children
- **Props Serialization**: Complex props (objects, arrays, functions) serialize correctly

### âœ… Route System
- **Route Definition**: `@define_route()` decorator with component dependencies
- **Component Tracking**: Routes track which React components they use
- **Dynamic Content**: Python functions can generate dynamic UI structures
- **Path Handling**: Support for root paths, nested paths, and parameterized routes

### âœ… TypeScript Code Generation
- **Inline Component Registries**: Each route file contains its own component imports and registry
- **JSON Serialization**: Complex UI trees serialize to valid TypeScript/JSON
- **Import Optimization**: Only imports components actually used by each route
- **File Generation**: Automatic creation of route files and routes configuration

### âœ… Advanced Patterns
- **Nested Components**: React components inside other React components
- **Mixed Content**: HTML elements and React components in the same tree
- **Stateful Components**: Client-side state management with server-side content
- **Dynamic Lists**: Python loops generating multiple component instances
- **Complex Props**: Objects, arrays, and various data types as component props

## ğŸ§© Example Usage Patterns

### Basic HTML Structure
```python
from pulse.html import div, h1, p

structure = div(className="page")[
    h1()["Page Title"],
    p()["Page content"]
]
```

### React Component Integration
```python
from pulse.html import define_react_component, define_route

# Define a React component
Counter = define_react_component("counter", "./Counter", "Counter", False)

@define_route("/demo", components=["counter"])
def demo_route():
    return div()[
        h1()["Demo Page"],
        Counter(count=42, label="Demo Counter")[
            "This text is server-rendered but appears inside the React component"
        ]
    ]
```

### Dynamic Content Generation
```python
@define_route("/users", components=["user-card"])
def users_route():
    users = fetch_users_from_api()  # Hypothetical API call
    
    return div()[
        h1()["Users"],
        div(className="users-grid")[
            *[UserCard(
                name=user["name"],
                email=user["email"]
            ) for user in users]
        ]
    ]
```

### Stateful Components with Server Children
```python
ColorBox = define_react_component("color-box", "./ColorBox", "ColorBox", False)

@define_route("/interactive", components=["color-box"])
def interactive_route():
    return div()[
        ColorBox(title="Interactive Demo", initialColor="blue")[
            h3()["Server-Rendered Content"],
            p()["This content was generated by Python"],
            ul()[
                li()["âœ… Server-side rendering"],
                li()["âœ… Client-side interactivity"]
            ]
        ]
    ]
```

## ğŸš€ System Architecture

```
Python Backend                 TypeScript Frontend
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Route Functions â”‚    â”€â”€â”€â–¶   â”‚  Generated .tsx  â”‚
â”‚  HTML Library    â”‚           â”‚  Component Reg.  â”‚
â”‚  React Componentsâ”‚           â”‚  UI Tree Data    â”‚
â”‚  UI Tree Gen.    â”‚           â”‚  React Rendering â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                             â”‚
         â–¼                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Code Generator â”‚           â”‚  Live React App  â”‚
â”‚  TypeScript Gen â”‚           â”‚  Stateful Comps  â”‚
â”‚  File Writing   â”‚           â”‚  Server Children â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ Development Workflow

1. **Define React Components** - Specify imports and exports
2. **Write Route Functions** - Use Python to generate UI trees
3. **Generate TypeScript** - Run code generator to create client files
4. **Start React App** - Serve generated routes with full React capabilities
5. **Real-time Updates** - WebSocket connection for live updates (optional)

## ğŸ“Š Test Results

All core functionality tests pass:
- âœ… Basic UI tree creation
- âœ… UI tree with children  
- âœ… Self-closing tags
- âœ… React component definition
- âœ… Route definition
- âœ… TypeScript generation
- âœ… Routes config generation
- âœ… Complex nested structures

The system successfully bridges Python server-side logic with React client-side interactivity, providing a powerful hybrid rendering approach.

## ğŸ‰ Benefits

- **Developer Experience**: Write UI logic in Python with familiar syntax
- **Performance**: Fast server-side rendering with client-side hydration
- **Flexibility**: Mix static HTML and interactive React components as needed
- **Type Safety**: Generated TypeScript provides full type checking
- **Real-time**: WebSocket integration enables live updates
- **Scalability**: Component-based architecture supports complex applications